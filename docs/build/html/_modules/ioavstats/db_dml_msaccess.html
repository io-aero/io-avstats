<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <link rel="shortcut icon" href="../../_static/IO-Aero_1_Favicon.ico"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.01.29 -->
        <title>ioavstats.db_dml_msaccess - IO-AVSTATS 24-3-22 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">IO-AVSTATS 24-3-22 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/IO-Aero_1_Logo.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration_io_avstats.html">Configuration IO-AVSTATS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration_logging.html">Configuration Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_steps.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_sources.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../db_administration.html">PostgreSQL Administration</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_master_logs.html">Master Data Logs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Master Data Logs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_01_s_d_c_23_08_21.html">1. Set up the database container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_02_c_d_s_23_08_21.html">2. Create the database schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_03_u_d_s_23_08_21.html">3. Update the database schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_11_a_o_c_23_08_21.html">4. Load aviation occurrence categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_12_l_a_p.html">5. Load airport data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_13_l_c_s_23_08_21.html">6. Load country and state data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_14_l_s_e_23_08_21.html">7. Load sequence of events data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_21_l_s_d_23_08_21.html">8. Load simplemaps data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pre2008_22_l_z_d.html">9. Load ZIP Code Database data into PostgreSQL</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../data_transaction_logs.html">Transaction Data Logs</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Transaction Data Logs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../2024_04_22_log_up22APR.html">2024.04.22 up22APR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_04_15_log_up15APR.html">2024.04.15 up15APR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_04_08_log_up08APR.html">2024.04.08 up08APR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_04_01_log_up01APR.html">2024.04.01 up01APR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_04_01_log_avall.html">2024.04.01 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_03_22_log_up22MAR.html">2024.03.22 up22MAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_03_15_log_up15MAR.html">2024.03.15 up15MAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_03_08_log_up08MAR.html">2024.03.08 up08MAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_03_01_log_up01MAR.html">2024.03.01 up01MAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_03_01_log_avall.html">2024.03.01 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_02_22_log_up22FEB.html">2024.02.22 up22FEB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_02_15_log_up15FEB.html">2024.02.15 up15FEB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_02_08_log_up08FEB.html">2024.02.08 up08FEB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_02_01_log_up01FEB.html">2024.02.01 up01FEB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_02_01_log_avall.html">2024.02.01 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_01_22_log_up22JAN.html">2024.01.22 up22JAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_01_15_log_up15JAN.html">2024.01.15 up15JAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_01_08_log_up08JAN.html">2024.01.08 up08JAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_01_01_log_up01JAN.html">2024.01.01 up01JAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2024_01_01_log_avall.html">2024.01.01 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_12_22_log_up22DEC.html">2023.12.22 up22DEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_12_15_log_up15DEC.html">2023.12.15 up15DEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_12_08_log_up08DEC.html">2023.12.08 up08DEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_12_04_log_up01DEC.html">2023.12.04 up01DEC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_12_04_log_avall.html">2023.12.04 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_11_22_log_up22NOV.html">2023.11.22 up22NOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_11_15_log_up15NOV.html">2023.11.15 up15NOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_11_08_log_up08NOV.html">2023.11.08 up08NOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_11_01_log_up01NOV.html">2023.11.01 up01NOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_11_01_log_avall.html">2023.11.01 avall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_10_22_log_up22OCT.html">2023.10.22 up22OCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_10_15_log_up15OCT.html">2023.10.15 up15OCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_10_08_log_up08OCT.html">2023.10.08 up08OCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_10_01_log_up01OCT.html">2023.10.01 up01OCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2023_10_01_log_avall.html">2023.10.01 avall</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules.html">ioavstats</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of ioavstats</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../ioavstats.html">ioavstats package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of ioavstats package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ioavstats.pages.html">ioavstats.pages package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LICENSE.html">End-User License Agreement</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for ioavstats.db_dml_msaccess</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2022-2024 IO-Aero. All rights reserved. Use of this</span>
<span class="c1"># source code is governed by the IO-Aero License, that can</span>
<span class="c1"># be found in the LICENSE.md file.</span>
<span class="sd">&quot;&quot;&quot;Managing the database schema of the PostgreSQL database.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">UTC</span><span class="p">,</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">pyodbc</span>  <span class="c1"># pylint: disable=import-error # type: ignore</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">iocommon</span> <span class="kn">import</span> <span class="n">db_utils</span><span class="p">,</span> <span class="n">io_config</span><span class="p">,</span> <span class="n">io_glob</span><span class="p">,</span> <span class="n">io_utils</span>
<span class="kn">from</span> <span class="nn">psycopg</span> <span class="kn">import</span> <span class="n">connection</span><span class="p">,</span> <span class="n">cursor</span>
<span class="kn">from</span> <span class="nn">psycopg.errors</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ForeignKeyViolation</span><span class="p">,</span>  <span class="c1"># pylint: disable=no-name-in-module</span>
    <span class="n">UniqueViolation</span><span class="p">,</span>  <span class="c1"># pylint: disable=no-name-in-module</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">ioavstats</span> <span class="kn">import</span> <span class="n">glob_local</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">utils_msaccess</span>

<span class="c1"># -----------------------------------------------------------------------------</span>
<span class="c1"># Global variables.</span>
<span class="c1"># -----------------------------------------------------------------------------</span>

<span class="n">COLUMN_CITY</span> <span class="o">=</span> <span class="s2">&quot;city&quot;</span>
<span class="n">COLUMN_COUNT</span> <span class="o">=</span> <span class="s2">&quot;count&quot;</span>
<span class="n">COLUMN_COUNTRY</span> <span class="o">=</span> <span class="s2">&quot;country&quot;</span>
<span class="n">COLUMN_DEC_LATITUDE</span> <span class="o">=</span> <span class="s2">&quot;dec_latitude&quot;</span>
<span class="n">COLUMN_DEC_LONGITUDE</span> <span class="o">=</span> <span class="s2">&quot;dec_longitude&quot;</span>
<span class="n">COLUMN_STATE</span> <span class="o">=</span> <span class="s2">&quot;state&quot;</span>

<span class="n">IO_LAST_SEEN</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Check for DDL changes.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># pylint: disable=too-many-lines</span>
<span class="k">def</span> <span class="nf">_check_ddl_changes</span><span class="p">(</span><span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for DDL changes.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">download_work_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
        <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">(),</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">download_work_dir</span><span class="p">,</span> <span class="p">(</span><span class="n">msaccess</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_MDB</span><span class="p">)),</span>
        <span class="n">Path</span><span class="p">(</span>
            <span class="n">download_work_dir</span><span class="p">,</span>
            <span class="p">(</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_profile</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_MDB</span><span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">msaccess_mdb</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">download_work_dir</span><span class="p">,</span> <span class="s2">&quot;IO-AVSTATS.mdb&quot;</span><span class="p">)</span>

    <span class="c1"># INFO.00.051 msaccess_file=&#39;{msaccess_file}&#39;</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_051</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess_file}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msaccess_mdb</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">msaccess_mdb</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="c1"># ERROR.00.932 File &#39;{filename}&#39; is not existing</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_932</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msaccess_mdb</span><span class="p">)),</span>
        <span class="p">)</span>

    <span class="n">msaccess_sql</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
        <span class="n">download_work_dir</span><span class="p">,</span>
        <span class="p">(</span><span class="n">msaccess</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_SQL</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># INFO.00.051 msaccess_file=&#39;{msaccess_file}&#39;</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_051</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess_file}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msaccess_sql</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">razorsql_jar_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">razorsql_java_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="n">razorsql_jar_file</span> <span class="o">=</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_jar_file_windows</span>
        <span class="n">razorsql_java_path</span> <span class="o">=</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_java_path_windows</span>
    <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
        <span class="n">razorsql_jar_file</span> <span class="o">=</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_jar_file_linux</span>
        <span class="n">razorsql_java_path</span> <span class="o">=</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_java_path_linux</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># ERROR.00.908 The operating system &#39;{os}&#39; is not supported</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_908</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{os}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()),</span>
        <span class="p">)</span>

    <span class="c1"># INFO.00.052 razorsql_jar_file=&#39;{razorsql_jar_file}&#39;</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_052</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{razorsql_jar_file}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">razorsql_jar_file</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">razorsql_jar_file</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="c1"># ERROR.00.932 File &#39;{filename}&#39; is not existing</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_932</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">razorsql_jar_file</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="c1"># INFO.00.053 razorsql_java_path=&#39;{razorsql_java_path}&#39;&quot;</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_053</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{razorsql_java_path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">razorsql_java_path</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="p">[</span>  <span class="c1"># noqa: S603</span>
            <span class="n">razorsql_java_path</span><span class="p">,</span>
            <span class="s2">&quot;-jar&quot;</span><span class="p">,</span>
            <span class="n">razorsql_jar_file</span><span class="p">,</span>
            <span class="s2">&quot;-backup&quot;</span><span class="p">,</span>
            <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_profile</span><span class="p">,</span>
            <span class="s2">&quot;null&quot;</span><span class="p">,</span>
            <span class="s2">&quot;null&quot;</span><span class="p">,</span>
            <span class="s2">&quot;;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;null&quot;</span><span class="p">,</span>
            <span class="n">msaccess_sql</span><span class="p">,</span>
            <span class="s2">&quot;NO&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tables&quot;</span><span class="p">,</span>
            <span class="s2">&quot;YES&quot;</span><span class="p">,</span>
            <span class="s2">&quot;null&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NO&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NO&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># INFO.00.011 The DDL script for the MS Access database &#39;{msaccess}&#39;</span>
    <span class="c1"># was created successfully</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_011</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">msaccess</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">:</span>
        <span class="c1"># INFO.00.020 The DDL script for the MS Access database &#39;{msaccess}&#39;</span>
        <span class="c1"># must be checked manually</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_020</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_compare_ddl</span><span class="p">(</span><span class="n">msaccess</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Compare the schema definitions with the reference file.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_compare_ddl</span><span class="p">(</span><span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare the schema definitions wirth the reference file.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">reference_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_reference_dir</span><span class="p">,</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">razorsql_reference_file</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># pylint: disable=consider-using-with</span>
    <span class="n">reference_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>  <span class="c1"># noqa: SIM115</span>
        <span class="n">encoding</span><span class="o">=</span><span class="n">io_glob</span><span class="o">.</span><span class="n">FILE_ENCODING_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">reference_file_lines</span> <span class="o">=</span> <span class="n">reference_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">reference_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">msaccess_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">,</span>
        <span class="p">(</span><span class="n">msaccess</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_SQL</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># pylint: disable=consider-using-with</span>
    <span class="n">msaccess_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">msaccess_filename</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>  <span class="c1"># noqa: SIM115</span>
        <span class="n">encoding</span><span class="o">=</span><span class="n">io_glob</span><span class="o">.</span><span class="n">FILE_ENCODING_DEFAULT</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">msaccess_file_lines</span> <span class="o">=</span> <span class="n">msaccess_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">msaccess_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference_file_lines</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">msaccess_file_lines</span><span class="p">):</span>
        <span class="c1"># ERROR.00.911 Number of lines differs: file &#39;{filename}&#39; lines</span>
        <span class="c1"># {filename_lines} versus file&#39;{reference}&#39; lines {reference_lines}</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_911</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess_filename</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename_lines}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msaccess_file_lines</span><span class="p">)))</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{reference}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">reference_filename</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{reference_lines}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">reference_file_lines</span><span class="p">))),</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">line_no</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reference_file_lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">msaccess_file_lines</span><span class="p">[</span><span class="n">line_no</span><span class="p">]:</span>
            <span class="c1"># INFO.00.009 line no.: {line_no}</span>
            <span class="c1"># INFO.00.010 {status} &#39;{line}&#39;</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg_core</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_009</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{line_no}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">line_no</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg_core</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_010</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{status}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;expected&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{line}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg_core</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_010</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{status}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;received&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{line}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">msaccess_file_lines</span><span class="p">[</span><span class="n">line_no</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="c1"># ERROR.00.910 The schema definition in file&#39;{filename}&#39;</span>
            <span class="c1"># does not match the reference definition in file&#39;{reference}&#39;</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_910</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">msaccess_filename</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{reference}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reference_filename</span><span class="p">)),</span>
            <span class="p">)</span>

    <span class="c1"># INFO.00.012 The DDL script for the MS Access database &#39;{msaccess}&#39;</span>
    <span class="c1"># is identical to the reference script</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_012</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">))</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Delete all the NTSB data.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_delete_ntsb_data</span><span class="p">(</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all the NTSB data.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="c1"># Level 4 - FK: ev_id &amp; Aircraft_Key &amp; crew_no</span>
        <span class="s2">&quot;dt_flight_crew&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flight_time&quot;</span><span class="p">,</span>
        <span class="c1"># Level 4 - FK: ev_id &amp; Aircraft_Key &amp; Occurrence_No</span>
        <span class="s2">&quot;seq_of_events&quot;</span><span class="p">,</span>
        <span class="c1"># Level 3 - FK: ev_id &amp; Aircraft_Key</span>
        <span class="s2">&quot;dt_aircraft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;engines&quot;</span><span class="p">,</span>
        <span class="s2">&quot;events_sequence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;findings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flight_crew&quot;</span><span class="p">,</span>
        <span class="s2">&quot;injury&quot;</span><span class="p">,</span>
        <span class="s2">&quot;narratives&quot;</span><span class="p">,</span>
        <span class="s2">&quot;occurrences&quot;</span><span class="p">,</span>
        <span class="c1"># Level 2 - FK: ev_id</span>
        <span class="s2">&quot;aircraft&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dt_events&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ntsb_admin&quot;</span><span class="p">,</span>
        <span class="c1"># Level 1 - without FK</span>
        <span class="s2">&quot;events&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT count(*)</span>
<span class="s2">          FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">row_pg</span> <span class="o">=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

        <span class="n">no_rows</span> <span class="o">=</span> <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_COUNT</span><span class="p">]</span> <span class="k">if</span> <span class="n">row_pg</span> <span class="k">else</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">no_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            TRUNCATE </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> CASCADE;</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">table</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> - number rows deleted : </span><span class="si">{</span><span class="n">no_rows</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Finalize processing.</span>
    <span class="c1"># ------------------------------------------------------------------</span>

    <span class="n">utils</span><span class="o">.</span><span class="n">upd_io_processed_files</span><span class="p">(</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_file_sequence_of_events</span><span class="p">,</span>
        <span class="n">cur_pg</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_pg</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn_pg</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load data from MS Access to the PostgreSQL database.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># pylint: disable=too-many-branches</span>
<span class="c1"># pylint: disable=too-many-locals</span>
<span class="c1"># pylint: disable=too-many-statements</span>
<div class="viewcode-block" id="load_ntsb_msaccess_data">
<a class="viewcode-back" href="../../ioavstats.html#ioavstats.db_dml_msaccess.load_ntsb_msaccess_data">[docs]</a>
<span class="k">def</span> <span class="nf">load_ntsb_msaccess_data</span><span class="p">(</span><span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data from MS Access to the PostgreSQL database.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        msaccess (str):</span>
<span class="sd">            The MS Access database file without file extension.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Start processing.</span>
    <span class="c1"># ------------------------------------------------------------------</span>

    <span class="c1"># pylint: disable=R0801</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
        <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">,</span>
        <span class="p">(</span><span class="n">msaccess</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_MDB</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="c1"># ERROR.00.912 The MS Access database file &#39;{filename}&#39; is missing</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_912</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)),</span>
        <span class="p">)</span>

    <span class="n">conn_ma</span><span class="p">,</span> <span class="n">cur_ma</span> <span class="o">=</span> <span class="n">utils_msaccess</span><span class="o">.</span><span class="n">get_msaccess_cursor</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">conn_pg</span><span class="p">,</span> <span class="n">cur_pg</span> <span class="o">=</span> <span class="n">db_utils</span><span class="o">.</span><span class="n">get_postgres_cursor</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">in</span> <span class="p">[</span><span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">]:</span>
        <span class="n">conn_pg</span><span class="o">.</span><span class="n">autocommit</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">msaccess</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">:</span>
        <span class="n">_delete_ntsb_data</span><span class="p">(</span><span class="n">conn_pg</span><span class="p">,</span> <span class="n">cur_pg</span><span class="p">)</span>

    <span class="n">is_table_aircraft</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_dt_aircraft</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_dt_events</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_dt_flight_crew</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_engines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_events</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_events_sequence</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_findings</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_flight_crew</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_flight_time</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_injury</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_narratives</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_ntsb_admin</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_occurrences</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">is_table_seq_of_events</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">table_info</span> <span class="ow">in</span> <span class="n">cur_ma</span><span class="o">.</span><span class="n">tables</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_AIRCRAFT</span><span class="p">:</span>
            <span class="n">is_table_aircraft</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_AIRCRAFT</span><span class="p">:</span>
            <span class="n">is_table_dt_aircraft</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_EVENTS</span><span class="p">:</span>
            <span class="n">is_table_dt_events</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_FLIGHT_CREW</span><span class="p">:</span>
            <span class="n">is_table_dt_flight_crew</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_ENGINES</span><span class="p">:</span>
            <span class="n">is_table_engines</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_EVENTS</span><span class="p">:</span>
            <span class="n">is_table_events</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_EVENTS_SEQUENCE</span><span class="p">:</span>
            <span class="n">is_table_events_sequence</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FINDINGS</span><span class="p">:</span>
            <span class="n">is_table_findings</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FLIGHT_CREW</span><span class="p">:</span>
            <span class="n">is_table_flight_crew</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FLIGHT_TIME</span><span class="p">:</span>
            <span class="n">is_table_flight_time</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_INJURY</span><span class="p">:</span>
            <span class="n">is_table_injury</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_NARRATIVES</span><span class="p">:</span>
            <span class="n">is_table_narratives</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_NTSB_ADMIN</span><span class="p">:</span>
            <span class="n">is_table_ntsb_admin</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_OCCURRENCES</span><span class="p">:</span>
            <span class="n">is_table_occurrences</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_SEQ_OF_EVENTS</span><span class="p">:</span>
            <span class="n">is_table_seq_of_events</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># INFO.00.021 The following database table is not processed: &#39;{msaccess}&#39;</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_021</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">table_info</span><span class="o">.</span><span class="n">table_name</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Load the NTSB data.</span>
    <span class="c1"># ------------------------------------------------------------------</span>

    <span class="c1"># Level 1 - without FK</span>
    <span class="k">if</span> <span class="n">is_table_events</span><span class="p">:</span>
        <span class="n">_load_table_events</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_EVENTS</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Level 2 - FK: ev_id</span>
    <span class="k">if</span> <span class="n">is_table_aircraft</span><span class="p">:</span>
        <span class="n">_load_table_aircraft</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_AIRCRAFT</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_dt_events</span><span class="p">:</span>
        <span class="n">_load_table_dt_events</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_EVENTS</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_ntsb_admin</span><span class="p">:</span>
        <span class="n">_load_table_ntsb_admin</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_NTSB_ADMIN</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Level 3 - FK: ev_id &amp; Aircraft_Key</span>
    <span class="k">if</span> <span class="n">is_table_dt_aircraft</span><span class="p">:</span>
        <span class="n">_load_table_dt_aircraft</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_AIRCRAFT</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_engines</span><span class="p">:</span>
        <span class="n">_load_table_engines</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_ENGINES</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_events_sequence</span><span class="p">:</span>
        <span class="n">_load_table_events_sequence</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_EVENTS_SEQUENCE</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_findings</span><span class="p">:</span>
        <span class="n">_load_table_findings</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FINDINGS</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_flight_crew</span><span class="p">:</span>
        <span class="n">_load_table_flight_crew</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FLIGHT_CREW</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_injury</span><span class="p">:</span>
        <span class="n">_load_table_injury</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_INJURY</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_narratives</span><span class="p">:</span>
        <span class="n">_load_table_narratives</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_NARRATIVES</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_occurrences</span><span class="p">:</span>
        <span class="n">_load_table_occurrences</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_OCCURRENCES</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Level 4 - FK: ev_id &amp; Aircraft_Key &amp; crew_no</span>
    <span class="k">if</span> <span class="n">is_table_dt_flight_crew</span><span class="p">:</span>
        <span class="n">_load_table_dt_flight_crew</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_DT_FLIGHT_CREW</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_table_flight_time</span><span class="p">:</span>
        <span class="n">_load_table_flight_time</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_FLIGHT_TIME</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Level 4 - FK: ev_id &amp; Aircraft_Key &amp; Occurrence_No</span>
    <span class="k">if</span> <span class="n">is_table_seq_of_events</span><span class="p">:</span>
        <span class="n">_load_table_seq_of_events</span><span class="p">(</span>
            <span class="n">msaccess</span><span class="p">,</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">TABLE_NAME_SEQ_OF_EVENTS</span><span class="p">,</span>
            <span class="n">cur_ma</span><span class="p">,</span>
            <span class="n">conn_pg</span><span class="p">,</span>
            <span class="n">cur_pg</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Finalize processing.</span>
    <span class="c1"># ------------------------------------------------------------------</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">autocommit</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># pylint: disable=R0801</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">upd_io_processed_files</span><span class="p">(</span><span class="n">msaccess</span><span class="p">,</span> <span class="n">cur_pg</span><span class="p">)</span>

    <span class="n">cur_pg</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn_pg</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">cur_ma</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn_ma</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span></div>



<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table aircraft.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_aircraft</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table aircraft.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="c1"># pylint: disable=R0801</span>
    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO aircraft (</span>
<span class="sd">                   ev_id,aircraft_key,regis_no,ntsb_no,acft_missing,far_part,flt_plan_filed,flight_plan_activated,damage,acft_fire,acft_expl,acft_make,</span>
<span class="sd">                   acft_model,acft_series,acft_serial_no,cert_max_gr_wt,acft_category,acft_reg_cls,homebuilt,fc_seats,cc_seats,pax_seats,total_seats,</span>
<span class="sd">                   num_eng,fixed_retractable,type_last_insp,date_last_insp,afm_hrs_last_insp,afm_hrs,elt_install,elt_oper,elt_aided_loc_ev,elt_type,</span>
<span class="sd">                   owner_acft,owner_street,owner_city,owner_state,owner_country,owner_zip,oper_individual_name,oper_name,oper_same,oper_dba,oper_addr_same,</span>
<span class="sd">                   oper_street,oper_city,oper_state,oper_country,oper_zip,oper_code,certs_held,oprtng_cert,oper_cert,oper_cert_num,oper_sched,oper_dom_int,</span>
<span class="sd">                   oper_pax_cargo,type_fly,second_pilot,dprt_pt_same_ev,dprt_apt_id,dprt_city,dprt_state,dprt_country,dprt_time,dprt_timezn,dest_same_local,</span>
<span class="sd">                   dest_apt_id,dest_city,dest_state,dest_country,phase_flt_spec,report_to_icao,evacuation,lchg_date,lchg_userid,afm_hrs_since,rwy_num,</span>
<span class="sd">                   rwy_len,rwy_width,site_seeing,air_medical,med_type_flight,acft_year,fuel_on_board,commercial_space_flight,unmanned,ifr_equipped_cert,</span>
<span class="sd">                   elt_mounted_aircraft,elt_connected_antenna,elt_manufacturer,elt_model,elt_reason_other,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">regis_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_missing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">far_part</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flt_plan_filed</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_plan_activated</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">damage</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_fire</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_expl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_series</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_serial_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cert_max_gr_wt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_reg_cls</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">homebuilt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pax_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">total_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">num_eng</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fixed_retractable</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_install</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_oper</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_aided_loc_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_acft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_individual_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dba</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_addr_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">certs_held</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oprtng_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_sched</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dom_int</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_pax_cargo</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_fly</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">second_pilot</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_pt_same_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_time</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_timezn</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_same_local</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_flt_spec</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">report_to_icao</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">evacuation</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_since</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_len</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_width</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">site_seeing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">air_medical</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_type_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_year</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fuel_on_board</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">commercial_space_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">unmanned</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ifr_equipped_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_mounted_aircraft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_connected_antenna</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_manufacturer</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_reason_other</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE aircraft</span>
<span class="sd">               SET regis_no = %s,ntsb_no = %s,acft_missing = %s,far_part = %s,flt_plan_filed = %s,flight_plan_activated = %s,damage = %s,acft_fire = %s,</span>
<span class="sd">                   acft_expl = %s,acft_make = %s,acft_model = %s,acft_series = %s,acft_serial_no = %s,cert_max_gr_wt = %s,acft_category = %s,</span>
<span class="sd">                   acft_reg_cls = %s,homebuilt = %s,fc_seats = %s,cc_seats = %s,pax_seats = %s,total_seats = %s,num_eng = %s,fixed_retractable = %s,</span>
<span class="sd">                   type_last_insp = %s,date_last_insp = %s,afm_hrs_last_insp = %s,afm_hrs = %s,elt_install = %s,elt_oper = %s,elt_aided_loc_ev = %s,</span>
<span class="sd">                   elt_type = %s,owner_acft = %s,owner_street = %s,owner_city = %s,owner_state = %s,owner_country = %s,owner_zip = %s,</span>
<span class="sd">                   oper_individual_name = %s,oper_name = %s,oper_same = %s,oper_dba = %s,oper_addr_same = %s,oper_street = %s,oper_city = %s,</span>
<span class="sd">                   oper_state = %s,oper_country = %s,oper_zip = %s,oper_code = %s,certs_held = %s,oprtng_cert = %s,oper_cert = %s,oper_cert_num = %s,</span>
<span class="sd">                   oper_sched = %s,oper_dom_int = %s,oper_pax_cargo = %s,type_fly = %s,second_pilot = %s,dprt_pt_same_ev = %s,dprt_apt_id = %s,</span>
<span class="sd">                   dprt_city = %s,dprt_state = %s,dprt_country = %s,dprt_time = %s,dprt_timezn = %s,dest_same_local = %s,dest_apt_id = %s,dest_city = %s,</span>
<span class="sd">                   dest_state = %s,dest_country = %s,phase_flt_spec = %s,report_to_icao = %s,evacuation = %s,lchg_date = %s,lchg_userid = %s,</span>
<span class="sd">                   afm_hrs_since = %s,rwy_num = %s,rwy_len = %s,rwy_width = %s,site_seeing = %s,air_medical = %s,med_type_flight = %s,acft_year = %s,</span>
<span class="sd">                   fuel_on_board = %s,commercial_space_flight = %s,unmanned = %s,ifr_equipped_cert = %s,elt_mounted_aircraft = %s,elt_connected_antenna = %s,</span>
<span class="sd">                   elt_manufacturer = %s,elt_model = %s,elt_reason_other = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (regis_no = %s AND ntsb_no = %s AND acft_missing = %s AND far_part = %s AND flt_plan_filed = %s AND flight_plan_activated = %s AND</span>
<span class="sd">                        damage = %s AND acft_fire = %s AND acft_expl = %s AND acft_make = %s AND acft_model = %s AND acft_series = %s AND</span>
<span class="sd">                        acft_serial_no = %s AND cert_max_gr_wt = %s AND acft_category = %s AND acft_reg_cls = %s AND homebuilt = %s AND fc_seats = %s AND</span>
<span class="sd">                        cc_seats = %s AND pax_seats = %s AND total_seats = %s AND num_eng = %s AND fixed_retractable = %s AND type_last_insp = %s AND</span>
<span class="sd">                        date_last_insp = %s AND afm_hrs_last_insp = %s AND afm_hrs = %s AND elt_install = %s AND elt_oper = %s AND elt_aided_loc_ev = %s AND</span>
<span class="sd">                        elt_type = %s AND owner_acft = %s AND owner_street = %s AND owner_city = %s AND owner_state = %s AND owner_country = %s AND</span>
<span class="sd">                        owner_zip = %s AND oper_individual_name = %s AND oper_name = %s AND oper_same = %s AND oper_dba = %s AND oper_addr_same = %s AND</span>
<span class="sd">                        oper_street = %s AND oper_city = %s AND oper_state = %s AND oper_country = %s AND oper_zip = %s AND oper_code = %s AND</span>
<span class="sd">                        certs_held = %s AND oprtng_cert = %s AND oper_cert = %s AND oper_cert_num = %s AND oper_sched = %s AND oper_dom_int = %s AND</span>
<span class="sd">                        oper_pax_cargo = %s AND type_fly = %s AND second_pilot = %s AND dprt_pt_same_ev = %s AND dprt_apt_id = %s AND dprt_city = %s AND</span>
<span class="sd">                        dprt_state = %s AND dprt_country = %s AND dprt_time = %s AND dprt_timezn = %s AND dest_same_local = %s AND dest_apt_id = %s AND</span>
<span class="sd">                        dest_city = %s AND dest_state = %s AND dest_country = %s AND phase_flt_spec = %s AND report_to_icao = %s AND evacuation = %s AND</span>
<span class="sd">                        lchg_date = %s AND lchg_userid = %s AND afm_hrs_since = %s AND rwy_num = %s AND rwy_len = %s AND rwy_width = %s AND site_seeing = %s AND</span>
<span class="sd">                        air_medical = %s AND med_type_flight = %s AND acft_year = %s AND fuel_on_board = %s AND commercial_space_flight = %s AND</span>
<span class="sd">                        unmanned = %s AND ifr_equipped_cert = %s AND elt_mounted_aircraft = %s AND elt_connected_antenna = %s AND elt_manufacturer = %s AND</span>
<span class="sd">                        elt_model = %s AND elt_reason_other = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">regis_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_missing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">far_part</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flt_plan_filed</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_plan_activated</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">damage</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_fire</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_expl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_series</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_serial_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cert_max_gr_wt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_reg_cls</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">homebuilt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pax_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">total_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">num_eng</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fixed_retractable</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_install</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_oper</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_aided_loc_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_acft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_individual_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dba</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_addr_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">certs_held</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oprtng_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_sched</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dom_int</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_pax_cargo</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_fly</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">second_pilot</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_pt_same_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_time</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_timezn</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_same_local</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_flt_spec</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">report_to_icao</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">evacuation</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_since</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_len</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_width</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">site_seeing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">air_medical</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_type_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_year</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fuel_on_board</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">commercial_space_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">unmanned</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ifr_equipped_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_mounted_aircraft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_connected_antenna</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_manufacturer</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_reason_other</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">regis_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_missing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">far_part</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flt_plan_filed</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_plan_activated</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">damage</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_fire</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_expl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_series</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_serial_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cert_max_gr_wt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_reg_cls</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">homebuilt</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cc_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pax_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">total_seats</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">num_eng</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fixed_retractable</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_install</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_oper</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_aided_loc_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_acft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">owner_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_individual_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dba</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_addr_same</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_street</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_zip</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">certs_held</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oprtng_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_cert_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_sched</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_dom_int</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">oper_pax_cargo</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">type_fly</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">second_pilot</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_pt_same_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_time</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dprt_timezn</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_same_local</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_apt_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">dest_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_flt_spec</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">report_to_icao</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">evacuation</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">afm_hrs_since</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_num</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_len</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rwy_width</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">site_seeing</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">air_medical</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_type_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">acft_year</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">fuel_on_board</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">commercial_space_flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">unmanned</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ifr_equipped_cert</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_mounted_aircraft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_connected_antenna</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_manufacturer</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">elt_reason_other</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table dt_aircraft.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_dt_aircraft</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table dt_aircraft.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO dt_aircraft (</span>
<span class="sd">                   ev_id,</span>
<span class="sd">                   aircraft_key,</span>
<span class="sd">                   col_name,</span>
<span class="sd">                   code,</span>
<span class="sd">                   lchg_date,</span>
<span class="sd">                   lchg_userid,</span>
<span class="sd">                   io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE dt_aircraft</span>
<span class="sd">               SET lchg_date = %s,</span>
<span class="sd">                   lchg_userid = %s,</span>
<span class="sd">                   io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE code = %s</span>
<span class="sd">               AND col_name = %s</span>
<span class="sd">               AND aircraft_key = %s</span>
<span class="sd">               AND ev_id = %s</span>
<span class="sd">               AND NOT (lchg_date = %s</span>
<span class="sd">                    AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;col_name=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;code=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table dt_events.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_dt_events</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table dt_events.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO dt_events (</span>
<span class="sd">                   ev_id,</span>
<span class="sd">                   col_name,</span>
<span class="sd">                   code,</span>
<span class="sd">                   lchg_date,</span>
<span class="sd">                   lchg_userid,</span>
<span class="sd">                   io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,</span>
<span class="sd">                   %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE dt_events</span>
<span class="sd">               SET lchg_date = %s,</span>
<span class="sd">                   lchg_userid = %s,</span>
<span class="sd">                   io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE code = %s</span>
<span class="sd">               AND col_name = %s</span>
<span class="sd">               AND ev_id = %s</span>
<span class="sd">               AND NOT (lchg_date = %s</span>
<span class="sd">                    AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;col_name=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;code=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table dt_flight_crew.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_dt_flight_crew</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table dt_flight_crew.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO dt_flight_crew (</span>
<span class="sd">                   ev_id,aircraft_key,crew_no,col_name,code,lchg_date,lchg_userid,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE dt_flight_crew</span>
<span class="sd">               SET lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE code = %s AND col_name = %s AND crew_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Aircraft_Key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;crew_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;col_name=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">col_name</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;code=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table engines.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_engines</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table engines.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO engines (</span>
<span class="sd">                   ev_id,aircraft_key,eng_no,eng_type,eng_mfgr,eng_model,power_units,hp_or_lbs,lchg_userid,lchg_date,carb_fuel_injection,propeller_type,</span>
<span class="sd">                   propeller_make,propeller_model,eng_time_total,eng_time_last_insp,eng_time_overhaul,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_mfgr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">power_units</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">hp_or_lbs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">carb_fuel_injection</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_total</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_overhaul</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE engines</span>
<span class="sd">               SET eng_type = %s,eng_mfgr = %s,eng_model = %s,power_units = %s,hp_or_lbs = %s,lchg_userid = %s,lchg_date = %s,carb_fuel_injection = %s,</span>
<span class="sd">                   propeller_type = %s,propeller_make = %s,propeller_model = %s,eng_time_total = %s,eng_time_last_insp = %s,eng_time_overhaul = %s,</span>
<span class="sd">                   io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE eng_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (eng_type = %s AND eng_mfgr = %s AND eng_model = %s AND power_units = %s AND hp_or_lbs = %s AND lchg_userid = %s AND</span>
<span class="sd">                        lchg_date = %s AND carb_fuel_injection = %s AND propeller_type = %s AND propeller_make = %s AND propeller_model = %s AND</span>
<span class="sd">                        eng_time_total = %s AND eng_time_last_insp = %s AND eng_time_overhaul = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_mfgr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">power_units</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">hp_or_lbs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">carb_fuel_injection</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_total</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_overhaul</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_mfgr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">power_units</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">hp_or_lbs</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">carb_fuel_injection</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_make</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">propeller_model</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_total</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_last_insp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_time_overhaul</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;eng_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">eng_no</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table events.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># pylint: disable=too-many-branches</span>
<span class="k">def</span> <span class="nf">_load_table_events</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table events.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msaccess</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">:</span>
                <span class="c1"># pylint: disable=line-too-long</span>
                <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                INSERT INTO events (</span>
<span class="sd">                       ev_id,ntsb_no,ev_type,ev_date,ev_dow,ev_time,ev_tmzn,ev_city,ev_state,ev_country,ev_site_zipcode,ev_year,ev_month,mid_air,</span>
<span class="sd">                       on_ground_collision,latitude,longitude,latlong_acq,apt_name,ev_nr_apt_id,ev_nr_apt_loc,apt_dist,apt_dir,apt_elev,wx_brief_comp,</span>
<span class="sd">                       wx_src_iic,wx_obs_time,wx_obs_dir,wx_obs_fac_id,wx_obs_elev,wx_obs_dist,wx_obs_tmzn,light_cond,sky_cond_nonceil,sky_nonceil_ht,</span>
<span class="sd">                       sky_ceil_ht,sky_cond_ceil,vis_rvr,vis_rvv,vis_sm,wx_temp,wx_dew_pt,wind_dir_deg,wind_dir_ind,wind_vel_kts,wind_vel_ind,gust_ind,</span>
<span class="sd">                       gust_kts,altimeter,wx_dens_alt,wx_int_precip,metar,ev_highest_injury,inj_f_grnd,inj_m_grnd,inj_s_grnd,inj_tot_f,inj_tot_m,inj_tot_n,</span>
<span class="sd">                       inj_tot_s,inj_tot_t,invest_agy,ntsb_docket,ntsb_notf_from,ntsb_notf_date,ntsb_notf_tm,fiche_number,lchg_date,lchg_userid,wx_cond_basic,</span>
<span class="sd">                       faa_dist_office,io_last_seen_ntsb</span>
<span class="sd">                       ) VALUES (</span>
<span class="sd">                       %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,</span>
<span class="sd">                       %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">                &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                        <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># pylint: disable=line-too-long</span>
                <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                INSERT INTO events (</span>
<span class="sd">                       ev_id,ntsb_no,ev_type,ev_date,ev_dow,ev_time,ev_tmzn,ev_city,ev_state,ev_country,ev_site_zipcode,ev_year,ev_month,mid_air,</span>
<span class="sd">                       on_ground_collision,latitude,longitude,latlong_acq,apt_name,ev_nr_apt_id,ev_nr_apt_loc,apt_dist,apt_dir,apt_elev,wx_brief_comp,</span>
<span class="sd">                       wx_src_iic,wx_obs_time,wx_obs_dir,wx_obs_fac_id,wx_obs_elev,wx_obs_dist,wx_obs_tmzn,light_cond,sky_cond_nonceil,sky_nonceil_ht,</span>
<span class="sd">                       sky_ceil_ht,sky_cond_ceil,vis_rvr,vis_rvv,vis_sm,wx_temp,wx_dew_pt,wind_dir_deg,wind_dir_ind,wind_vel_kts,wind_vel_ind,gust_ind,</span>
<span class="sd">                       gust_kts,altimeter,wx_dens_alt,wx_int_precip,metar,ev_highest_injury,inj_f_grnd,inj_m_grnd,inj_s_grnd,inj_tot_f,inj_tot_m,inj_tot_n,</span>
<span class="sd">                       inj_tot_s,inj_tot_t,invest_agy,ntsb_docket,ntsb_notf_from,ntsb_notf_date,ntsb_notf_tm,fiche_number,lchg_date,lchg_userid,wx_cond_basic,</span>
<span class="sd">                       faa_dist_office,dec_latitude,dec_longitude,io_last_seen_ntsb</span>
<span class="sd">                       ) VALUES (</span>
<span class="sd">                       %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,</span>
<span class="sd">                       %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">                &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_latitude</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_longitude</span><span class="p">,</span>
                        <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">]:</span>
                <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Inserted ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> ev_year=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">msaccess</span> <span class="o">==</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">:</span>
                <span class="c1"># pylint: disable=line-too-long</span>
                <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                UPDATE events</span>
<span class="sd">                   SET ntsb_no = %s,ev_type = %s,ev_date = %s,ev_dow = %s,ev_time = %s,ev_tmzn = %s,ev_city = %s,ev_state = %s,ev_country = %s,</span>
<span class="sd">                       ev_site_zipcode = %s,ev_year = %s,ev_month = %s,mid_air = %s,on_ground_collision = %s,latitude = %s,longitude = %s,latlong_acq = %s,</span>
<span class="sd">                       apt_name = %s,ev_nr_apt_id = %s,ev_nr_apt_loc = %s,apt_dist = %s,apt_dir = %s,apt_elev = %s,wx_brief_comp = %s,wx_src_iic = %s,</span>
<span class="sd">                       wx_obs_time = %s,wx_obs_dir = %s,wx_obs_fac_id = %s,wx_obs_elev = %s,wx_obs_dist = %s,wx_obs_tmzn = %s,light_cond = %s,</span>
<span class="sd">                       sky_cond_nonceil = %s,sky_nonceil_ht = %s,sky_ceil_ht = %s,sky_cond_ceil = %s,vis_rvr = %s,vis_rvv = %s,vis_sm = %s,wx_temp = %s,</span>
<span class="sd">                       wx_dew_pt = %s,wind_dir_deg = %s,wind_dir_ind = %s,wind_vel_kts = %s,wind_vel_ind = %s,gust_ind = %s,gust_kts = %s,altimeter = %s,</span>
<span class="sd">                       wx_dens_alt = %s,wx_int_precip = %s,metar = %s,ev_highest_injury = %s,inj_f_grnd = %s,inj_m_grnd = %s,inj_s_grnd = %s,inj_tot_f = %s,</span>
<span class="sd">                       inj_tot_m = %s,inj_tot_n = %s,inj_tot_s = %s,inj_tot_t = %s,invest_agy = %s,ntsb_docket = %s,ntsb_notf_from = %s,ntsb_notf_date = %s,</span>
<span class="sd">                       ntsb_notf_tm = %s,fiche_number = %s,lchg_date = %s,lchg_userid = %s,wx_cond_basic = %s,faa_dist_office = %s,io_last_seen_ntsb = %s</span>
<span class="sd">                 WHERE ev_id = %s</span>
<span class="sd">                   AND NOT (ntsb_no = %s AND ev_type = %s AND ev_date = %s AND ev_dow = %s AND ev_time = %s AND ev_tmzn = %s AND ev_city = %s AND</span>
<span class="sd">                            ev_state = %s AND ev_country = %s AND ev_site_zipcode = %s AND ev_year = %s AND ev_month = %s AND mid_air = %s AND</span>
<span class="sd">                            on_ground_collision = %s AND latitude = %s AND longitude = %s AND latlong_acq = %s AND apt_name = %s AND ev_nr_apt_id = %s AND</span>
<span class="sd">                            ev_nr_apt_loc = %s AND apt_dist = %s AND apt_dir = %s AND apt_elev = %s AND wx_brief_comp = %s AND wx_src_iic = %s AND</span>
<span class="sd">                            wx_obs_time = %s AND wx_obs_dir = %s AND wx_obs_fac_id = %s AND wx_obs_elev = %s AND wx_obs_dist = %s AND wx_obs_tmzn = %s AND</span>
<span class="sd">                            light_cond = %s AND sky_cond_nonceil = %s AND sky_nonceil_ht = %s AND sky_ceil_ht = %s AND sky_cond_ceil = %s AND vis_rvr = %s AND</span>
<span class="sd">                            vis_rvv = %s AND vis_sm = %s AND wx_temp = %s AND wx_dew_pt = %s AND wind_dir_deg = %s AND wind_dir_ind = %s AND</span>
<span class="sd">                            wind_vel_kts = %s AND wind_vel_ind = %s AND gust_ind = %s AND gust_kts = %s AND altimeter = %s AND wx_dens_alt = %s AND</span>
<span class="sd">                            wx_int_precip = %s AND metar = %s AND ev_highest_injury = %s AND inj_f_grnd = %s AND inj_m_grnd = %s AND inj_s_grnd = %s AND</span>
<span class="sd">                            inj_tot_f = %s AND inj_tot_m = %s AND inj_tot_n = %s AND inj_tot_s = %s AND inj_tot_t = %s AND invest_agy = %s AND</span>
<span class="sd">                            ntsb_docket = %s AND ntsb_notf_from = %s AND ntsb_notf_date = %s AND ntsb_notf_tm = %s AND fiche_number = %s AND</span>
<span class="sd">                            lchg_date = %s AND lchg_userid = %s AND wx_cond_basic = %s AND faa_dist_office = %s);</span>
<span class="sd">                &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                        <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># pylint: disable=line-too-long</span>
                <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                UPDATE events</span>
<span class="sd">                   SET ntsb_no = %s,ev_type = %s,ev_date = %s,ev_dow = %s,ev_time = %s,ev_tmzn = %s,ev_city = %s,ev_state = %s,ev_country = %s,</span>
<span class="sd">                   ev_site_zipcode = %s,ev_year = %s,ev_month = %s,mid_air = %s,on_ground_collision = %s,latitude = %s,longitude = %s,latlong_acq = %s,</span>
<span class="sd">                   apt_name = %s,ev_nr_apt_id = %s,ev_nr_apt_loc = %s,apt_dist = %s,apt_dir = %s,apt_elev = %s,wx_brief_comp = %s,wx_src_iic = %s,</span>
<span class="sd">                   wx_obs_time = %s,wx_obs_dir = %s,wx_obs_fac_id = %s,wx_obs_elev = %s,wx_obs_dist = %s,wx_obs_tmzn = %s,light_cond = %s,</span>
<span class="sd">                   sky_cond_nonceil = %s,sky_nonceil_ht = %s,sky_ceil_ht = %s,sky_cond_ceil = %s,vis_rvr = %s,vis_rvv = %s,vis_sm = %s,</span>
<span class="sd">                   wx_temp = %s,wx_dew_pt = %s,wind_dir_deg = %s,wind_dir_ind = %s,wind_vel_kts = %s,wind_vel_ind = %s,gust_ind = %s,gust_kts = %s,</span>
<span class="sd">                   altimeter = %s,wx_dens_alt = %s,wx_int_precip = %s,metar = %s,ev_highest_injury = %s,inj_f_grnd = %s,inj_m_grnd = %s,inj_s_grnd = %s,</span>
<span class="sd">                   inj_tot_f = %s,inj_tot_m = %s,inj_tot_n = %s,inj_tot_s = %s,inj_tot_t = %s,invest_agy = %s,ntsb_docket = %s,ntsb_notf_from = %s,</span>
<span class="sd">                   ntsb_notf_date = %s,ntsb_notf_tm = %s,fiche_number = %s,lchg_date = %s,lchg_userid = %s,wx_cond_basic = %s,faa_dist_office = %s,</span>
<span class="sd">                   dec_latitude = %s,dec_longitude = %s,io_last_seen_ntsb = %s</span>
<span class="sd">                 WHERE ev_id = %s</span>
<span class="sd">                   AND NOT (ntsb_no = %s AND ev_type = %s AND ev_date = %s AND ev_dow = %s AND ev_time = %s AND ev_tmzn = %s AND ev_city = %s AND</span>
<span class="sd">                            ev_state = %s AND ev_country = %s AND ev_site_zipcode = %s AND ev_year = %s AND ev_month = %s AND mid_air = %s AND</span>
<span class="sd">                            on_ground_collision = %s AND latitude = %s AND longitude = %s AND latlong_acq = %s AND apt_name = %s AND ev_nr_apt_id = %s AND</span>
<span class="sd">                            ev_nr_apt_loc = %s AND apt_dist = %s AND apt_dir = %s AND apt_elev = %s AND wx_brief_comp = %s AND wx_src_iic = %s AND</span>
<span class="sd">                            wx_obs_time = %s AND wx_obs_dir = %s AND wx_obs_fac_id = %s AND wx_obs_elev = %s AND wx_obs_dist = %s AND wx_obs_tmzn = %s AND</span>
<span class="sd">                            light_cond = %s AND sky_cond_nonceil = %s AND sky_nonceil_ht = %s AND sky_ceil_ht = %s AND sky_cond_ceil = %s AND</span>
<span class="sd">                            vis_rvr = %s AND vis_rvv = %s AND vis_sm = %s AND wx_temp = %s AND wx_dew_pt = %s AND wind_dir_deg = %s AND</span>
<span class="sd">                            wind_dir_ind = %s AND wind_vel_kts = %s AND wind_vel_ind = %s AND gust_ind = %s AND gust_kts = %s AND altimeter = %s AND</span>
<span class="sd">                            wx_dens_alt = %s AND wx_int_precip = %s AND metar = %s AND ev_highest_injury = %s AND inj_f_grnd = %s AND inj_m_grnd = %s AND</span>
<span class="sd">                            inj_s_grnd = %s AND inj_tot_f = %s AND inj_tot_m = %s AND inj_tot_n = %s AND inj_tot_s = %s AND inj_tot_t = %s AND</span>
<span class="sd">                            invest_agy = %s AND ntsb_docket = %s AND ntsb_notf_from = %s AND ntsb_notf_date = %s AND ntsb_notf_tm = %s AND</span>
<span class="sd">                            fiche_number = %s AND lchg_date = %s AND lchg_userid = %s AND wx_cond_basic = %s AND faa_dist_office = %s</span>
<span class="sd">                            AND dec_latitude = %s AND dec_longitude = %s);</span>
<span class="sd">                &quot;&quot;&quot;</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_latitude</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_longitude</span><span class="p">,</span>
                        <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_no</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_type</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_dow</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_tmzn</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_city</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_state</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_country</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_site_zipcode</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_month</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">mid_air</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">on_ground_collision</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="p">(</span>
                            <span class="kc">None</span>
                            <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span>
                                <span class="k">else</span> <span class="kc">None</span>
                            <span class="p">)</span>
                        <span class="p">),</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">latlong_acq</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_name</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_nr_apt_loc</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">apt_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_brief_comp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_src_iic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_time</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dir</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_fac_id</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_elev</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_dist</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_obs_tmzn</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">light_cond</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_nonceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_nonceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_ceil_ht</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">sky_cond_ceil</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvr</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_rvv</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">vis_sm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_temp</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dew_pt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_deg</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_dir_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wind_vel_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_ind</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">gust_kts</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">altimeter</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_dens_alt</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_int_precip</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">metar</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_highest_injury</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_f_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_m_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_s_grnd</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_f</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_m</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_n</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_s</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_tot_t</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">invest_agy</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_docket</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_from</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">ntsb_notf_tm</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">fiche_number</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">wx_cond_basic</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">faa_dist_office</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_latitude</span><span class="p">,</span>
                        <span class="n">row_mdb</span><span class="o">.</span><span class="n">dec_longitude</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> ev_year=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table events_sequence.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_events_sequence</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table events_sequence.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO events_sequence (</span>
<span class="sd">                   ev_id,aircraft_key,occurrence_no,occurrence_code,occurrence_description,phase_no,eventsoe_no,defining_ev,lchg_date,lchg_userid,</span>
<span class="sd">                   io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eventsoe_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Defining_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE events_sequence</span>
<span class="sd">               SET occurrence_code = %s,occurrence_description = %s,phase_no = %s,eventsoe_no = %s,defining_ev = %s,lchg_date = %s,lchg_userid = %s,</span>
<span class="sd">                   io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE occurrence_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (occurrence_code = %s AND occurrence_description = %s AND phase_no = %s AND eventsoe_no = %s AND defining_ev = %s AND</span>
<span class="sd">                        lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eventsoe_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Defining_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">phase_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">eventsoe_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Defining_ev</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Aircraft_Key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Occurrence_No=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table findings.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_findings</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table findings.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO findings (</span>
<span class="sd">                   ev_id,</span>
<span class="sd">                   aircraft_key,</span>
<span class="sd">                   finding_no,</span>
<span class="sd">                   finding_code,</span>
<span class="sd">                   finding_description,</span>
<span class="sd">                   category_no,</span>
<span class="sd">                   subcategory_no,</span>
<span class="sd">                   section_no,</span>
<span class="sd">                   subsection_no,</span>
<span class="sd">                   modifier_no,</span>
<span class="sd">                   cause_factor,</span>
<span class="sd">                   cm_inPc,</span>
<span class="sd">                   lchg_date,</span>
<span class="sd">                   lchg_userid,</span>
<span class="sd">                   io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">category_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subcategory_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">section_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subsection_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">modifier_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cm_inPc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE findings</span>
<span class="sd">               SET finding_code = %s,</span>
<span class="sd">                   finding_description = %s,</span>
<span class="sd">                   category_no = %s,</span>
<span class="sd">                   subcategory_no = %s,</span>
<span class="sd">                   section_no = %s,</span>
<span class="sd">                   subsection_no = %s,</span>
<span class="sd">                   modifier_no = %s,</span>
<span class="sd">                   cause_factor = %s,</span>
<span class="sd">                   cm_inpc = %s,</span>
<span class="sd">                   lchg_date = %s,</span>
<span class="sd">                   lchg_userid = %s,</span>
<span class="sd">                   io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE finding_no = %s</span>
<span class="sd">               AND aircraft_key = %s</span>
<span class="sd">               AND ev_id = %s</span>
<span class="sd">               AND NOT (finding_code = %s</span>
<span class="sd">                    AND finding_description = %s</span>
<span class="sd">                    AND category_no = %s</span>
<span class="sd">                    AND subcategory_no = %s</span>
<span class="sd">                    AND section_no = %s</span>
<span class="sd">                    AND subsection_no = %s</span>
<span class="sd">                    AND modifier_no = %s</span>
<span class="sd">                    AND cause_factor = %s</span>
<span class="sd">                    AND cm_inpc = %s</span>
<span class="sd">                    AND lchg_date = %s</span>
<span class="sd">                    AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">category_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subcategory_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">section_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subsection_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">modifier_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cm_inPc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_description</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">category_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subcategory_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">section_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">subsection_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">modifier_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">cm_inPc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;finding_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">finding_no</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table flight_crew.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_flight_crew</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table flight_crew.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO flight_crew (</span>
<span class="sd">                   ev_id,aircraft_key,crew_no,crew_category,crew_age,crew_sex,crew_city,crew_res_state,crew_res_country,med_certf,med_crtf_vldty,</span>
<span class="sd">                   date_lst_med,crew_rat_endorse,crew_inj_level,seatbelts_used,shldr_harn_used,crew_tox_perf,seat_occ_pic,pc_profession,bfr,bfr_date,</span>
<span class="sd">                   ft_as_of,lchg_date,lchg_userid,seat_occ_row,infl_rest_inst,infl_rest_depl,child_restraint,med_crtf_limit,mr_faa_med_certf,pilot_flying,</span>
<span class="sd">                   available_restraint,restraint_used,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_age</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_sex</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_vldty</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_lst_med</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_rat_endorse</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_inj_level</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seatbelts_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">shldr_harn_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_tox_perf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_pic</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pc_profession</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ft_as_of</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_row</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_inst</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_depl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">child_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_limit</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">mr_faa_med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pilot_flying</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">available_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">restraint_used</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE flight_crew</span>
<span class="sd">               SET crew_category = %s,crew_age = %s,crew_sex = %s,crew_city = %s,crew_res_state = %s,crew_res_country = %s,med_certf = %s,</span>
<span class="sd">                   med_crtf_vldty = %s,date_lst_med = %s,crew_rat_endorse = %s,crew_inj_level = %s,seatbelts_used = %s,shldr_harn_used = %s,</span>
<span class="sd">                   crew_tox_perf = %s,seat_occ_pic = %s,pc_profession = %s,bfr = %s,bfr_date = %s,ft_as_of = %s,lchg_date = %s,lchg_userid = %s,</span>
<span class="sd">                   seat_occ_row = %s,infl_rest_inst = %s,infl_rest_depl = %s,child_restraint = %s,med_crtf_limit = %s,mr_faa_med_certf = %s,</span>
<span class="sd">                   pilot_flying = %s,available_restraint = %s,restraint_used = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE crew_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (crew_category = %s AND crew_age = %s AND crew_sex = %s AND crew_city = %s AND crew_res_state = %s AND crew_res_country = %s AND</span>
<span class="sd">                        med_certf = %s AND med_crtf_vldty = %s AND date_lst_med = %s AND crew_rat_endorse = %s AND crew_inj_level = %s AND</span>
<span class="sd">                        seatbelts_used = %s AND shldr_harn_used = %s AND crew_tox_perf = %s AND seat_occ_pic = %s AND pc_profession = %s AND bfr = %s AND</span>
<span class="sd">                        bfr_date = %s AND ft_as_of = %s AND lchg_date = %s AND lchg_userid = %s AND seat_occ_row = %s AND infl_rest_inst = %s AND</span>
<span class="sd">                        infl_rest_depl = %s AND child_restraint = %s AND med_crtf_limit = %s AND mr_faa_med_certf = %s AND pilot_flying = %s AND</span>
<span class="sd">                        available_restraint = %s AND restraint_used = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_age</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_sex</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_vldty</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_lst_med</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_rat_endorse</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_inj_level</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seatbelts_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">shldr_harn_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_tox_perf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_pic</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pc_profession</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ft_as_of</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_row</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_inst</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_depl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">child_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_limit</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">mr_faa_med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pilot_flying</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">available_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">restraint_used</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_age</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_sex</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_city</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_state</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_res_country</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_vldty</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">date_lst_med</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_rat_endorse</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_inj_level</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seatbelts_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">shldr_harn_used</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_tox_perf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_pic</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pc_profession</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">bfr_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ft_as_of</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seat_occ_row</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_inst</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">infl_rest_depl</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">child_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">med_crtf_limit</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">mr_faa_med_certf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">pilot_flying</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">available_restraint</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">restraint_used</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;crew_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table flight_time.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_flight_time</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table flight_time.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO flight_time (</span>
<span class="sd">                   ev_id,aircraft_key,crew_no,flight_type,flight_craft,flight_hours,lchg_date,lchg_userid,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_craft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_hours</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE flight_time</span>
<span class="sd">               SET flight_hours = %s,lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE flight_craft = %s AND flight_type = %s AND crew_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (flight_hours = %s AND lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_hours</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_craft</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_type</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_hours</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;crew_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">crew_no</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;flight_type=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_type</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;flight_craft=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">flight_craft</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table injury.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_injury</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table injury.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO injury (</span>
<span class="sd">                   ev_id,aircraft_key,inj_person_category,injury_level,inj_person_count,lchg_date,lchg_userid,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">injury_level</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_count</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE injury</span>
<span class="sd">               SET inj_person_count = %s,lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE injury_level = %s AND inj_person_category = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (inj_person_count = %s AND lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_count</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">injury_level</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_category</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_count</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;inj_person_category=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">inj_person_category</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;injury_level=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">injury_level</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Determine and load city averages.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_io_lat_lng_average</span><span class="p">(</span><span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span> <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine and load city averages.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Delete averaged data.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DELETE FROM io_lat_lng</span>
<span class="sd">     WHERE</span>
<span class="sd">           source = %s;</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">SOURCE_AVERAGE</span><span class="p">,),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

        <span class="c1"># INFO.00.063 Processed data source &#39;{data_source}&#39;</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_063</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{data_source}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">SOURCE_AVERAGE</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows deleted  : </span><span class="si">{</span><span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># Insert averaged data.</span>
    <span class="c1"># ------------------------------------------------------------------</span>
    <span class="c1"># INFO.00.062 Database table io_lat_lng: Load the averaged city data</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_062</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

    <span class="n">count_duplicates</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">conn_pg_2</span><span class="p">,</span> <span class="n">cur_pg_2</span> <span class="o">=</span> <span class="n">db_utils</span><span class="o">.</span><span class="n">get_postgres_cursor</span><span class="p">()</span>

    <span class="n">conn_pg_2</span><span class="o">.</span><span class="n">autocommit</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># pylint: disable=line-too-long</span>
    <span class="n">cur_pg_2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT country, state, city, sum(dec_latitude)/count(*) dec_latitude, sum(dec_longitude)/count(*) dec_longitude</span>
<span class="s2">      FROM io_lat_lng</span>
<span class="s2">     WHERE type = &#39;</span><span class="si">{</span><span class="n">glob_local</span><span class="o">.</span><span class="n">IO_LAT_LNG_TYPE_ZIPCODE</span><span class="si">}</span><span class="s2">&#39;</span>
<span class="s2">     GROUP BY country, state, city;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">row_pg</span> <span class="ow">in</span> <span class="n">cur_pg_2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO io_lat_lng (</span>
<span class="sd">                   type,</span>
<span class="sd">                   country,</span>
<span class="sd">                   state,</span>
<span class="sd">                   city,</span>
<span class="sd">                   dec_latitude,</span>
<span class="sd">                   dec_longitude,</span>
<span class="sd">                   source,</span>
<span class="sd">                   first_processed</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,</span>
<span class="sd">                   %s,%s,%s</span>
<span class="sd">                   )</span>
<span class="sd">            ON CONFLICT ON CONSTRAINT io_lat_lng_type_country_state_city_zipcode_key</span>
<span class="sd">            DO NOTHING;</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">IO_LAT_LNG_TYPE_CITY</span><span class="p">,</span>
                    <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_COUNTRY</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                    <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_STATE</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                    <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_CITY</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                    <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_DEC_LATITUDE</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                    <span class="n">row_pg</span><span class="p">[</span><span class="n">COLUMN_DEC_LONGITUDE</span><span class="p">],</span>  <span class="c1"># type: ignore</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">SOURCE_AVERAGE</span><span class="p">,</span>
                    <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">UTC</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">count_duplicates</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">cur_pg_2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">conn_pg_2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_duplicates</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows duplicate: </span><span class="si">{</span><span class="n">count_duplicates</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table narratives.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_narratives</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table narratives.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="c1"># pylint: disable=line-too-long</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO narratives (</span>
<span class="sd">                   ev_id,aircraft_key,narr_accp,narr_accf,narr_cause,narr_inc,lchg_date,lchg_userid,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_cause</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_inc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE narratives</span>
<span class="sd">               SET narr_accp = %s,narr_accf = %s,narr_cause = %s,narr_inc = %s,lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (narr_accp = %s AND narr_accf = %s AND narr_cause = %s AND narr_inc = %s AND lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_cause</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_inc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accp</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_accf</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_cause</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">narr_inc</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table ntsb_admin.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_ntsb_admin</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table ntsb_admin.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;20210527103155&quot;</span><span class="p">,</span> <span class="s2">&quot;20220328104839&quot;</span><span class="p">]:</span>
            <span class="c1"># ERROR.00.946 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_946</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO ntsb_admin (</span>
<span class="sd">                   ev_id,rec_stat,approval_date,lchg_userid,lchg_date,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rec_stat</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">approval_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE ntsb_admin</span>
<span class="sd">               SET rec_stat = %s,approval_date = %s,lchg_userid = %s,lchg_date = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE ev_id = %s</span>
<span class="sd">               AND NOT (rec_stat = %s AND approval_date = %s AND lchg_userid = %s AND lchg_date = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rec_stat</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">approval_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">rec_stat</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">approval_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ForeignKeyViolation</span><span class="p">:</span>
            <span class="c1"># ERROR.00.947 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_947</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table occurrences.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_occurrences</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table occurrences.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;20001213X25705&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001213X29793&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001213X30454&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001213X31758&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001213X32752&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001218X45444&quot;</span><span class="p">,</span>
            <span class="s2">&quot;20001218X45446&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="c1"># ERROR.00.946 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_946</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO occurrences (</span>
<span class="sd">                   ev_id,aircraft_key,occurrence_no,occurrence_code,phase_of_flight,altitude,lchg_date,lchg_userid,io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Phase_of_Flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Altitude</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE occurrences</span>
<span class="sd">               SET occurrence_code = %s,phase_of_flight = %s,altitude = %s,lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE occurrence_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (occurrence_code = %s AND phase_of_flight = %s AND altitude = %s AND lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Phase_of_Flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Altitude</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Phase_of_Flight</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Altitude</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Occurrence_No=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="n">ForeignKeyViolation</span><span class="p">:</span>
            <span class="c1"># ERROR.00.947 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_947</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Load the data from database table seq_of_events.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_load_table_seq_of_events</span><span class="p">(</span>
    <span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cur_mdb</span><span class="p">:</span> <span class="n">pyodbc</span><span class="o">.</span><span class="n">Cursor</span><span class="p">,</span>
    <span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">,</span>
    <span class="n">cur_pg</span><span class="p">:</span> <span class="n">cursor</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from database table seq_of_events.&quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">count_insert</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_select</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_update</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Database table       : </span><span class="si">{</span><span class="n">table_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">:</span><span class="s2">30</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cur_mdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">;&quot;</span><span class="p">)</span>

    <span class="n">rows_mdb</span> <span class="o">=</span> <span class="n">cur_mdb</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row_mdb</span> <span class="ow">in</span> <span class="n">rows_mdb</span><span class="p">:</span>
        <span class="n">count_select</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count_select</span> <span class="o">%</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">database_commit_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of rows so far read : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;20020917X03487&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="c1"># ERROR.00.946 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_946</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># pylint: disable=line-too-long</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            INSERT INTO seq_of_events (</span>
<span class="sd">                   ev_id,aircraft_key,occurrence_no,seq_event_no,group_code,subj_code,cause_factor,modifier_code,person_code,lchg_date,lchg_userid,</span>
<span class="sd">                   io_last_seen_ntsb</span>
<span class="sd">                   ) VALUES (</span>
<span class="sd">                   %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seq_event_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">group_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Subj_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Modifier_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Person_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="n">count_insert</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">UniqueViolation</span><span class="p">:</span>
            <span class="n">cur_pg</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            UPDATE seq_of_events</span>
<span class="sd">               SET aircraft_key = %s,occurrence_no = %s,seq_event_no = %s,group_code = %s,subj_code = %s,cause_factor = %s,modifier_code = %s,</span>
<span class="sd">                   person_code = %s,lchg_date = %s,lchg_userid = %s,io_last_seen_ntsb = %s</span>
<span class="sd">             WHERE group_code = %s AND seq_event_no = %s AND occurrence_no = %s AND aircraft_key = %s AND ev_id = %s</span>
<span class="sd">               AND NOT (subj_code = %s AND cause_factor = %s AND modifier_code = %s AND person_code = %s AND lchg_date = %s AND lchg_userid = %s);</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seq_event_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">group_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Subj_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Modifier_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Person_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                    <span class="n">IO_LAST_SEEN</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">group_code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">seq_event_no</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Subj_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Cause_Factor</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Modifier_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">Person_Code</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_date</span><span class="p">,</span>
                    <span class="n">row_mdb</span><span class="o">.</span><span class="n">lchg_userid</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">count_update</span> <span class="o">+=</span> <span class="n">cur_pg</span><span class="o">.</span><span class="n">rowcount</span>
                <span class="k">if</span> <span class="n">msaccess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_AVALL</span><span class="p">,</span>
                    <span class="n">glob_local</span><span class="o">.</span><span class="n">MSACCESS_PRE2008</span><span class="p">,</span>
                <span class="p">]:</span>
                    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Updated  ev_id=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;aircraft_key=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Aircraft_Key</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Occurrence_No=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">Occurrence_No</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;seq_event_no=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">seq_event_no</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;group_code=</span><span class="si">{</span><span class="n">row_mdb</span><span class="o">.</span><span class="n">group_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">except</span> <span class="n">ForeignKeyViolation</span><span class="p">:</span>
            <span class="c1"># ERROR.00.947 The ev_id &#39;{ev_id}&#39; is missing in database table events</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_947</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{ev_id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">row_mdb</span><span class="o">.</span><span class="n">ev_id</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">conn_pg</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>

    <span class="n">conn_pg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows selected : </span><span class="si">{</span><span class="n">count_select</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_insert</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows inserted : </span><span class="si">{</span><span class="n">count_insert</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count_update</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number rows updated  : </span><span class="si">{</span><span class="n">count_update</span><span class="si">!s:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Execute a query that returns the list of CICTT codes.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_sql_query_cictt_codes</span><span class="p">(</span><span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">with</span> <span class="n">conn_pg</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SELECT cictt_code</span>
<span class="sd">          FROM io_aviation_occurrence_categories;</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;cictt_code&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Execute a query that returns the list of US states.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="k">def</span> <span class="nf">_sql_query_us_states</span><span class="p">(</span><span class="n">conn_pg</span><span class="p">:</span> <span class="n">connection</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="k">with</span> <span class="n">conn_pg</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span> <span class="k">as</span> <span class="n">cur</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SELECT state</span>
<span class="sd">          FROM io_states</span>
<span class="sd">         WHERE country = &#39;USA&#39;;</span>
<span class="sd">        &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Download an MS Access database file.</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># pylint: disable=too-many-branches</span>
<span class="c1"># pylint: disable=too-many-locals</span>
<span class="c1"># pylint: disable=too-many-statements</span>
<div class="viewcode-block" id="download_ntsb_msaccess_file">
<a class="viewcode-back" href="../../ioavstats.html#ioavstats.db_dml_msaccess.download_ntsb_msaccess_file">[docs]</a>
<span class="k">def</span> <span class="nf">download_ntsb_msaccess_file</span><span class="p">(</span><span class="n">msaccess</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download an MS Access database file.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        msaccess (str):</span>
<span class="sd">            The MS Access database file without file extension.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_START</span><span class="p">)</span>

    <span class="n">filename_zip</span> <span class="o">=</span> <span class="n">msaccess</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">glob_local</span><span class="o">.</span><span class="n">FILE_EXTENSION_ZIP</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_url_ntsb_prefix</span> <span class="o">+</span> <span class="n">filename_zip</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">file_resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_timeout</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">file_resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="c1"># ERROR.00.906 Unexpected response status code=&#39;{status_code}&#39;</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_906</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">{status_code}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">file_resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="c1"># INFO.00.013 The connection to the MS Access database file &#39;{msaccess}.zip&#39;</span>
        <span class="c1"># on the NTSB download page was successfully established</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_013</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">)</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span>
                <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">filename_zip</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">,</span> <span class="n">filename_zip</span><span class="p">)</span>

        <span class="n">no_chunks</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename_zip</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_zip</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">file_resp</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span>
                <span class="n">chunk_size</span><span class="o">=</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_chunk_size</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">file_zip</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
                <span class="n">no_chunks</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># INFO.00.014 From the file &#39;{msaccess}&#39; {no_chunks} chunks were downloaded</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_014</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{no_chunks}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">no_chunks</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">zipped_files</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span>  <span class="c1"># pylint: disable=consider-using-with</span>
                <span class="n">filename_zip</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">zipped_file</span> <span class="ow">in</span> <span class="n">zipped_files</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
                <span class="n">zipped_files</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">zipped_file</span><span class="p">,</span> <span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_work_dir</span><span class="p">)</span>

            <span class="n">zipped_files</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">BadZipFile</span><span class="p">:</span>
            <span class="c1"># ERROR.00.907 File&#39;{filename}&#39; is not a zip file</span>
            <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
                <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_907</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{filename}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename_zip</span><span class="p">)),</span>
            <span class="p">)</span>

        <span class="n">Path</span><span class="p">(</span><span class="n">filename_zip</span><span class="p">)</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="c1"># INFO.00.015 The file &#39;{msaccess}.zip&#39;  was successfully unpacked</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">progress_msg</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">INFO_00_015</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{msaccess}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">msaccess</span><span class="p">))</span>

        <span class="n">_check_ddl_changes</span><span class="p">(</span><span class="n">msaccess</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ConnectionError</span><span class="p">:</span>
        <span class="c1"># ERROR.00.905 Connection problem with url=&#39;{url}&#39;</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span><span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_905</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{url}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
        <span class="c1"># ERROR.00.909 Timeout after&#39;{timeout}&#39; seconds with url=&#39;{url}</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">terminate_fatal</span><span class="p">(</span>
            <span class="n">glob_local</span><span class="o">.</span><span class="n">ERROR_00_909</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{timeout}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">io_config</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">download_timeout</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{url}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">url</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">io_glob</span><span class="o">.</span><span class="n">LOGGER_END</span><span class="p">)</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022 - 2024, IO-Aero
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=dff755f8"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>