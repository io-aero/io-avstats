#!/bin/bash

set -e

# ------------------------------------------------------------------------------
#
# run_cloud_files_zip.sh: File Collection for AWS.
#
# ------------------------------------------------------------------------------

export AWS_FILE_NAME=cloud.zip
export AWS_PROG_ZIP=7z

echo "================================================================================"
echo "Start $0"
echo "--------------------------------------------------------------------------------"
echo "File Collection for AWS"
echo "--------------------------------------------------------------------------------"
date +"DATE TIME : %d.%m.%Y %H:%M:%S"
echo "================================================================================"
echo "Collecting Files"
echo "--------------------------------------------------------------------------------"

rm -f ${AWS_FILE_NAME}

copy -i data/latest_postgrep.zip download/AVSTATS-DB.zip

${AWS_PROG_ZIP} a -tzip ${AWS_FILE_NAME} data/latest_postgres.zip \
                                         config/docker-compose_cloud.yml \
                                         config/nginx.conf \
                                         scripts/run_cloud_setup_instance.sh \
                                         scripts/run_docker_compose_cloud.sh

echo ""
echo "================================================================================"
echo "Archive Content"
echo "--------------------------------------------------------------------------------"
${AWS_PROG_ZIP} l ${AWS_FILE_NAME}
echo "================================================================================"

echo ""
echo "--------------------------------------------------------------------------------"
date +"DATE TIME : %d.%m.%Y %H:%M:%S"
echo "--------------------------------------------------------------------------------"
echo "End   $0"
echo "================================================================================"
